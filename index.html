<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>æ°¸çºŒç”Ÿæ´»å°è¨˜è€…è¡Œå‹•è¨ˆç•«</title>
  
  <!-- å¼•å…¥ Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@600;900&display=swap" rel="stylesheet">

  <style>
    /* æ°¸çºŒä¸»é¡Œé…è‰² */
    :root { --b:#2e7d32; --g:#c8e6c9; --mut:#558b2f; --bg:#f1f8e9; }
    
    body {
      font-family: "Microsoft JhengHei", "PingFang TC", "Noto Sans TC", system-ui, sans-serif;
      margin: 0; 
      color: #1b5e20;
      padding-bottom: 120px; 
      background-color: var(--bg);
      background-image: url('https://lh3.googleusercontent.com/d/1PMMbc6X59Ifwywx8fg2beaCXEBB_iBtZ');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      background-repeat: no-repeat;
    }
    
    .wrap { 
      max-width: 800px; 
      margin: 20px auto; 
      padding: 24px; 
      background: rgba(255, 255, 255, 0.85); 
      border-radius: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
      backdrop-filter: blur(3px); 
    }

    /* === æ ¸å¿ƒï¼šæ³¨éŸ³æ’ç‰ˆåŸºç¤ === */
    .z-word {
      display: inline-flex;
      align-items: center;
      margin: 0 0.25rem 0 0;
      vertical-align: middle;
      font-family: "Microsoft JhengHei", "KaiTi", sans-serif;
      position: relative;
      white-space: nowrap; 
      height: 2.6rem; 
    }
    .z-char {
      font-size: 1.6rem; 
      line-height: 1.1;
      font-weight: bold;
      color: #1b5e20;
      margin-right: 0px;
    }
    .z-yin {
      display: inline-flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
      width: 0.85rem;
      height: 1.6rem; 
      font-size: 0.7rem;
      line-height: 1;
      color: #33691e;
      font-weight: normal;
    }
    .yin-symbol { display: block; height: 0.53rem; line-height: 0.53rem; text-align: center; }
    
    /* è²èª¿å¾®èª¿ï¼šå¾€å·¦ç§»é¿å…èˆ‡å³é‚Šæ–‡å­—é‡ç–Š */
    .tone { position: absolute; font-family: system-ui, sans-serif; font-size: 0.55rem; }
    .tone-2, .tone-3, .tone-4 { 
      right: -0.20rem; /* å¾€å·¦ç§»ä»¥ç·Šè²¼æ³¨éŸ³ */
      top: 50%; 
      transform: translateY(-30%); 
      width: 0.4rem; 
      text-align: left; 
    }
    .tone-0 { top: -0.5rem; left: 50%; transform: translateX(-50%); }

    /* æ¨™ç±¤ã€æŒ‰éˆ•ã€è³‡è¨Šæ¬„å­—é«” */
    label .z-word, .step-text .z-word, .btn .z-word, .news-info .z-word { height: auto; margin-right: 0.1rem; }
    label .z-char, .step-text .z-char, .news-info .z-char { font-size: 18px !important; }
    label .z-yin, .step-text .z-yin, .news-info .z-yin { font-size: 0.42rem; width: 0.48rem; height: auto; }

    h1 .z-char { font-size: 2.2rem; color: #1b5e20; }
    h1 .z-yin { font-size: 0.45rem; width: 0.55rem; margin-left: 2px; }

    .card { 
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid #a5d6a7; 
      border-radius: 16px; 
      padding: 16px; 
      box-shadow: 0 4px 6px rgba(46, 125, 50, 0.05);
      margin-bottom: 16px; 
    }
    .row { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }
    .center { justify-content: center; }
    .between { justify-content: space-between; }
    
    .btn {
      border: 1px solid var(--b); background: #388e3c; color: #fff; 
      padding: 10px 14px; border-radius: 12px; cursor: pointer; 
      font-size: 14px; display: inline-flex; align-items: center; gap: 6px;
      font-weight: bold; transition: all 0.2s; box-shadow: 0 2px 0 #1b5e20;
    }
    .btn:active { transform: translateY(2px); box-shadow: none; }
    /* ä¿®æ”¹å›ä¸Šä¸€æ­¥æŒ‰éˆ•çš„é¡è‰² */
.btn.back {
  background: #558b2f;      /* ğŸ‘ˆ æ”¹ç‚ºè¼ƒæ·±çš„è‰ç¶ è‰² */
  color: #ffffff;           /* ğŸ‘ˆ æ–‡å­—æ”¹ç‚ºç™½è‰² */
  border: 1px solid #33691e;
  box-shadow: 0 2px 0 #2e7d32;
}

/* ç¢ºä¿æŒ‰éˆ•å…§çš„åœ‹å­—èˆ‡æ³¨éŸ³éƒ½æ˜¯ç™½è‰² */
.btn.back .z-char, 
.btn.back .z-yin,
.btn.back span {
  color: #ffffff !important;
}
    .btn.large { width: 100%; justify-content: center; padding: 12px; background: #2e7d32; }
    .btn.edit { background: #558b2f; }
    .btn.retry { background: #ef6c00; }
    
    .btn .z-char { font-size: 1rem !important; color: #fff; }
    .btn .z-yin { font-size: 0.38rem; color: #fff; }

    .input-group { display: flex; gap: 8px; margin-top: 6px; align-items: center; width: 100%; }
    .input-group input, input[type="text"], select, textarea { 
      flex: 1; padding: 12px; border: 1px solid #a5d6a7; border-radius: 10px; font-size: 16px; 
      box-sizing: border-box; background: #fff; font-family: "Microsoft JhengHei", sans-serif; color: #333;
      width: 100%;
    }
    
    .btn.record { 
        background: #66bb6a; border: none; padding: 8px; 
        box-shadow: 0 3px 0 #2e7d32; border-radius: 50%;
        width: 40px; height: 40px; flex-shrink: 0;
        display: flex; align-items: center; justify-content: center;
        transition: all 0.1s; touch-action: manipulation;
    }
    .btn.recording { animation: pulse 1s infinite; background: #ef5350; box-shadow: 0 3px 0 #c62828; }

    .canvasWrap {
      position: relative; width: 100%; 
      border: 2px dashed #81c784; border-radius: 12px; 
      overflow: hidden; background: #f1f8e9;
      display: flex; justify-content: center; align-items: center;
      min-height: 250px; touch-action: none;
    }
    canvas { display: block; max-width: 100%; height: auto; cursor: crosshair; }
    
    .severity-group { display: flex; flex-direction: column; gap: 10px; margin-top: 5px; }
    .checkbox-label {
  display: flex; 
  align-items: center; 
  gap: 6px; 
  cursor: pointer;
  background: #e8f5e9; 
  padding: 10px 10px; 
  border-radius: 10px; 
  border: 1px solid #c8e6c9;
  
  /* --- å¢åŠ ä»¥ä¸‹è¨­å®š --- */
  font-weight: normal;   /* ç¢ºä¿å¤–æ¡†å®¹å™¨ä¸ä½¿ç”¨ç²—é«” */
}

/* åŒæ™‚ä¹Ÿè¦ç¢ºä¿å…§éƒ¨çš„åœ‹å­—ä¸è¢«è¨­ç‚ºç²—é«” */
.checkbox-label .z-char {
  font-size: 16px !important;    
  font-weight: normal !important; /* ç¢ºä¿å®ƒæ˜¯ç´°é«” */
}
    .checkbox-label input { width: 18px; height: 18px; margin-right: 8px; transform: scale(1.2); }

    .page-section { display: none; animation: fadeIn 0.3s; }
    .page-section.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    #report {
      width: 794px; min-height: 1123px; padding: 20px 60px 35px 60px; 
      margin: 0 auto; box-sizing: border-box;
      position: relative; display: flex; flex-direction: column;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
      background: linear-gradient(rgba(255, 255, 255, 0.85), rgba(255, 255, 255, 0.85)), url('https://lh3.googleusercontent.com/d/1SOoxXby6ucek-k1CK6IgDVrFxg-98Vdi');
      background-size: cover; background-position: center;
    }
    
    .news-header { 
      border-bottom: 3px double #2e7d32; 
      margin-bottom: 20px; padding-bottom: 15px; 
      display: flex; flex-direction: row; 
      justify-content: center; align-items: center; gap: 15px; 
    }
    
    .news-info { display: flex; justify-content: space-between; align-items: center; color: #333; font-size: 14px; margin-bottom: 10px; width: 100%; font-weight: bold; }

    #rTitleContainer {
      font-size: 1.8rem;
      text-align: center;
      width: 100%;
      margin: -5px 0 18px 0;
      padding: 10px 0;
      border-top: 1px solid rgba(0,0,0,0.1);
      border-bottom: 1px solid rgba(0,0,0,0.1);
      display: flex; justify-content: center; align-items: center; flex-wrap: wrap;
      line-height: 1.4;
      min-height: 4.5rem;
    }

    .rImg-wrap {
      width: 100%; height: 280px; 
      display: flex; align-items: center; justify-content: center; 
      margin: 0 auto 20px auto; 
      background: transparent; 
      overflow: hidden;
      border: none;
    }
   #rImg { 
  max-width: 100%; 
  max-height: 100%; 
  width: auto; 
  height: auto; 
  object-fit: contain; 
}

    .news-content-block { line-height: 2.8; font-size: 12px; text-align: justify; flex-grow: 1; padding: 10px; }
    .news-footer { 
      margin-top: 40px; text-align: center; color: #333; font-size: 14px; 
      border-top: 1px solid rgba(0,0,0,0.1); padding-top: 10px; font-weight: bold; 
    }

    #ai-loading { display: none; text-align: center; padding: 20px; font-size: 1.2rem; color: #2e7d32; }
    .loader { border: 4px solid #f3f3f3; border-top: 4px solid #2e7d32; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; display: inline-block; vertical-align: middle; margin-right: 10px; }
    .hidden { display: none !important; }
  @keyframes sand-timer {
    0% { transform: rotate(0deg); }
    50% { transform: rotate(180deg); }
    100% { transform: rotate(180deg); }
  }

  .waiting-icon {
    display: inline-block;
    animation: sand-timer 2s infinite;
    font-size: 1.5rem; /* ä½ å¯ä»¥èª¿æ•´æ²™æ¼çš„å¤§å° */
    margin-right: 8px; /* è®“æ²™æ¼è·Ÿæ–‡å­—ä¿æŒè·é›¢ */
    vertical-align: middle;
  }
#newsContent .z-punctuation {
  font-size: 1.4rem !important; /* æ”¾å¤§ç¬¦è™Ÿ */
  height: 2.4rem !important;    /* é…åˆå…§æ–‡æ–‡å­—é«˜åº¦ */
  margin: 0 0.1rem;
  color: #333;                  /* è®“å…§æ–‡ç¬¦è™Ÿé¡è‰²æ·±ä¸€é»ï¼Œå¥½é–±è®€ */
  display: inline-flex;
  align-items: center;
  vertical-align: middle;
}
  </style>
</head>

<body>

  <div class="wrap">
    
    <!-- ç·¨è¼¯å€ -->
    <div id="page-edit" class="page-section active">
      <div style="text-align:center; margin-bottom:20px;">
        <img src="https://lh3.googleusercontent.com/d/1ybyLQCc_DIAUeS23tz-sORNL43Vv2Kan" style="height: 80px;" alt="Logo">
        <h1>
          <span class="z-word"><span class="z-char">æ°¸</span><span class="z-yin"><span class="yin-symbol">ã„©</span><span class="yin-symbol">ã„¥</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">çºŒ</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„©</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">ç”Ÿ</span><span class="z-yin"><span class="yin-symbol">ã„•</span><span class="yin-symbol">ã„¥</span></span></span><span class="z-word"><span class="z-char">æ´»</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„›</span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">å°</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„ </span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">è¨˜</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„§</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">è€…</span><span class="z-yin"><span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„œ</span><span class="tone tone-3">Ë‡</span></span></span>
        </h1>
      </div>

      <div class="card">
        <div class="row step-text">
<span class="step-badge" style="background:#c8e6c9; display: inline-flex; align-items: center; padding: 4px 10px;">
  <span class="z-word">
    <span class="z-char">æ­¥</span>
    <span class="z-yin">
      <span class="yin-symbol">ã„…</span>
      <span class="yin-symbol">ã„¨</span>
      <span class="tone tone-4">Ë‹</span>
    </span>
  </span>
  <span class="z-word">
    <span class="z-char">é©Ÿ</span>
    <span class="z-yin">
      <span class="yin-symbol">ã„“</span>
      <span class="yin-symbol">ã„¡</span>
      <span class="tone tone-4">Ë‹</span>
    </span>
  </span>
  <span style="font-weight: bold; margin-left: 2px; font-size: 1.1rem;">1</span>
</span>
          <span class="z-word"><span class="z-char">ä¸Š</span><span class="z-yin"><span class="yin-symbol">ã„•</span><span class="yin-symbol">ã„¤</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">å‚³</span><span class="z-yin"><span class="yin-symbol">ã„”</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„¢</span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">ç…§</span><span class="z-yin"><span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„ </span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">ç‰‡</span><span class="z-yin"><span class="yin-symbol">ã„†</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span><span class="tone tone-4">Ë‹</span></span></span>
        </div>
        <div style="margin-top:15px;">
          <input id="photoInput" type="file" accept="image/*" style="display: none;" />
          
          <label for="photoInput" class="btn">
            <span class="z-word">
              <span class="z-char">é¸</span>
              <span class="z-yin">
                <span class="yin-symbol">ã„’</span>
                <span class="yin-symbol">ã„©</span>
                <span class="yin-symbol">ã„¢</span>
                <span class="tone tone-3">Ë‡</span>
              </span>
            </span>
            <span class="z-word">
              <span class="z-char">æ“‡</span>
              <span class="z-yin">
                <span class="yin-symbol">ã„—</span>
                <span class="yin-symbol">ã„œ</span>
                <span class="tone tone-2">ËŠ</span>
              </span>
            </span>
            <span class="z-word">
              <span class="z-char">ç…§</span>
              <span class="z-yin">
                <span class="yin-symbol">ã„“</span>
                <span class="yin-symbol">ã„ </span>
                <span class="tone tone-4">Ë‹</span>
              </span>
            </span>
            <span class="z-word">
              <span class="z-char">ç‰‡</span>
              <span class="z-yin">
                <span class="yin-symbol">ã„†</span>
                <span class="yin-symbol">ã„§</span>
                <span class="yin-symbol">ã„¢</span>
                <span class="tone tone-4">Ë‹</span>
              </span>
            </span>
          </label>
          
          <span id="fileNameHint" style="font-size: 12px; color: #666; margin-left: 10px; vertical-align: middle;"></span>
        </div>
      </div>

      <div class="card">
        <div class="row between step-text">
          <div class="row">
<span class="step-badge" style="background:#c8e6c9; display: inline-flex; align-items: center; padding: 4px 10px;">
  <span class="z-word">
    <span class="z-char">æ­¥</span>
    <span class="z-yin">
      <span class="yin-symbol">ã„…</span>
      <span class="yin-symbol">ã„¨</span>
      <span class="tone tone-4">Ë‹</span>
    </span>
  </span>
  <span class="z-word">
    <span class="z-char">é©Ÿ</span>
    <span class="z-yin">
      <span class="yin-symbol">ã„“</span>
      <span class="yin-symbol">ã„¡</span>
      <span class="tone tone-4">Ë‹</span>
    </span>
  </span>
  <span style="font-weight: bold; margin-left: 2px; font-size: 1.1rem;">2</span>
</span>
            <span class="z-word"><span class="z-char">åœˆ</span><span class="z-yin"><span class="yin-symbol">ã„‘</span><span class="yin-symbol">ã„©</span><span class="yin-symbol">ã„¢</span></span></span><span class="z-word"><span class="z-char">é¸</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„©</span><span class="yin-symbol">ã„¢</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">å•</span><span class="z-yin"><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„£</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">é¡Œ</span><span class="z-yin"><span class="yin-symbol">ã„Š</span><span class="yin-symbol">ã„§</span><span class="tone tone-2">ËŠ</span></span></span>
          </div>
          <div class="row">
            <button class="btn secondary" id="btnUndo" type="button" disabled>â†©</button>
            <button class="btn secondary" id="btnClear" type="button" disabled>ğŸ—‘</button>
          </div>
        </div>
        <div class="canvasWrap" style="margin-top:10px;">
          <div id="placeholderText" style="text-align: center; display: flex; align-items: center; justify-content: center; opacity: 0.7;">
  <span style="font-size: 1rem; vertical-align: middle; margin-right: 4px;">ğŸ“¸</span>
  
  <span class="z-word" style="height: 1.8rem;">
    <span class="z-char" style="font-size: 1.2rem !important;">è«‹</span>
    <span class="z-yin" style="font-size: 0.5rem !important; width: 0.4rem !important;">
      <span class="yin-symbol">ã„‘</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¥</span><span class="tone tone-3" style="font-size: 0.3rem !important;">Ë‡</span>
    </span>
  </span>

  <span class="z-word" style="height: 1.8rem;">
    <span class="z-char" style="font-size: 1.2rem !important;">å…ˆ</span>
    <span class="z-yin" style="font-size: 0.5rem !important; width: 0.4rem !important;">
      <span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span>
    </span>
  </span>

  <span class="z-word" style="height: 1.8rem;">
    <span class="z-char" style="font-size: 1.2rem !important;">é¸</span>
    <span class="z-yin" style="font-size: 0.5rem !important; width: 0.4rem !important;">
      <span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„©</span><span class="yin-symbol">ã„¢</span><span class="tone tone-3" style="font-size: 0.3rem !important;">Ë‡</span>
    </span>
  </span>

  <span class="z-word" style="height: 1.8rem;">
    <span class="z-char" style="font-size: 1.2rem !important;">æ“‡</span>
    <span class="z-yin" style="font-size: 0.5rem !important; width: 0.4rem !important;">
      <span class="yin-symbol">ã„—</span><span class="yin-symbol">ã„œ</span><span class="tone tone-2" style="font-size: 0.3rem !important;">ËŠ</span>
    </span>
  </span>

  <span class="z-word" style="height: 1.8rem;">
    <span class="z-char" style="font-size: 1.2rem !important;">ç…§</span>
    <span class="z-yin" style="font-size: 0.5rem !important; width: 0.4rem !important;">
      <span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„ </span><span class="tone tone-4" style="font-size: 0.3rem !important;">Ë‹</span>
    </span>
  </span>

  <span class="z-word" style="height: 1.8rem;">
    <span class="z-char" style="font-size: 1.2rem !important;">ç‰‡</span>
    <span class="z-yin" style="font-size: 0.5rem !important; width: 0.4rem !important;">
      <span class="yin-symbol">ã„†</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span><span class="tone tone-4" style="font-size: 0.3rem !important;">Ë‹</span>
    </span>
  </span>
</div>
          <canvas id="canvas" class="hidden"></canvas>
        </div>
      </div>

      <div class="card">
        <div class="row step-text">
<span class="step-badge" style="background:#c8e6c9; display: inline-flex; align-items: center; padding: 4px 10px;">
  <span class="z-word">
    <span class="z-char">æ­¥</span>
    <span class="z-yin">
      <span class="yin-symbol">ã„…</span>
      <span class="yin-symbol">ã„¨</span>
      <span class="tone tone-4">Ë‹</span>
    </span>
  </span>
  <span class="z-word">
    <span class="z-char">é©Ÿ</span>
    <span class="z-yin">
      <span class="yin-symbol">ã„“</span>
      <span class="yin-symbol">ã„¡</span>
      <span class="tone tone-4">Ë‹</span>
    </span>
  </span>
  <span style="font-weight: bold; margin-left: 2px; font-size: 1.1rem;">3</span>
</span>
          <span class="z-word"><span class="z-char">å¡«</span><span class="z-yin"><span class="yin-symbol">ã„Š</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">å¯«</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">è³‡</span><span class="z-yin"><span class="yin-symbol">ã„—</span></span></span><span class="z-word"><span class="z-char">æ–™</span><span class="z-yin"><span class="yin-symbol">ã„Œ</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„ </span><span class="tone tone-4">Ë‹</span></span></span>
        </div>

        <!-- å§“åèˆ‡çµ„åˆ¥ä¿®å¾©å¤§å°è·‘æ‰å•é¡Œï¼šç¨ç«‹è¡Œé¡¯ç¤ºä¸¦åŠ å¤§ -->
        <div style="margin-top:16px;">
          <label> <span class="z-word"> <span class="z-char">å°</span> <span class="z-yin"> <span class="yin-symbol">ã„’</span> <span class="yin-symbol">ã„§</span> <span class="yin-symbol">ã„ </span> <span class="tone tone-3">Ë‡</span> </span> </span> <span class="z-word"> <span class="z-char">è¨˜</span> <span class="z-yin"> <span class="yin-symbol">ã„</span> <span class="yin-symbol">ã„§</span> <span class="tone tone-4">Ë‹</span> </span> </span> <span class="z-word"> <span class="z-char">è€…</span> <span class="z-yin"> <span class="yin-symbol">ã„“</span> <span class="yin-symbol">ã„œ</span> <span class="tone tone-3">Ë‡</span> </span> </span> <span class="z-word"> <span class="z-char">å§“</span> <span class="z-yin"> <span class="yin-symbol">ã„’</span> <span class="yin-symbol">ã„§</span> <span class="yin-symbol">ã„¥</span> <span class="tone tone-4">Ë‹</span> </span> </span> <span class="z-word"> <span class="z-char">å</span> <span class="z-yin"> <span class="yin-symbol">ã„‡</span> <span class="yin-symbol">ã„§</span> <span class="yin-symbol">ã„¥</span> <span class="tone tone-2">ËŠ</span> </span> </span> </label>
          <input id="reporterName" type="text" placeholder="">
        </div>

        <div style="margin-top:16px;">
          <label>
            <span class="z-word"><span class="z-char">çµ„</span><span class="z-yin"><span class="yin-symbol">ã„—</span><span class="yin-symbol">ã„¨</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">åˆ¥</span><span class="z-yin"><span class="yin-symbol">ã„…</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„</span><span class="tone tone-2">ËŠ</span></span></span>
          </label>
          <select id="team">
            <option value="" disabled selected></option>
            <option value="Açµ„">Açµ„</option><option value="Bçµ„">Bçµ„</option><option value="Cçµ„">Cçµ„</option>
          </select>
        </div>

        <div style="margin-top:16px;">
          <label><span class="z-word"><span class="z-char">ç™¼</span><span class="z-yin"><span class="yin-symbol">ã„ˆ</span><span class="yin-symbol">ã„š</span></span></span><span class="z-word"><span class="z-char">ç¾</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">åœ°</span><span class="z-yin"><span class="yin-symbol">ã„‰</span><span class="yin-symbol">ã„§</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">é»</span><span class="z-yin"><span class="yin-symbol">ã„‰</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span><span class="tone tone-3">Ë‡</span></span></span></label>
          <div class="input-group"><input id="locationInput" type="text"><button id="btnMicLocation" type="button" class="btn record">ğŸ¤</button></div>
        </div>

        <div style="margin-top:16px;">
          <label><span class="z-word"><span class="z-char">ç¾</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">æ³</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„¤</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">æ</span><span class="z-yin"><span class="yin-symbol">ã„‡</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„ </span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">è¿°</span><span class="z-yin"><span class="yin-symbol">ã„•</span><span class="yin-symbol">ã„¨</span><span class="tone tone-4">Ë‹</span></span></span></label>
          <div class="input-group"><input id="problemInput" type="text"><button id="btnMicProblem" type="button" class="btn record">ğŸ¤</button></div>
        </div>

        <div style="margin-top:16px;">
          <label><span class="z-word"><span class="z-char">æ½›</span><span class="z-yin"><span class="yin-symbol">ã„‘</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">åœ¨</span><span class="z-yin"><span class="yin-symbol">ã„—</span><span class="yin-symbol">ã„</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">é¢¨</span><span class="z-yin"><span class="yin-symbol">ã„ˆ</span><span class="yin-symbol">ã„¥</span></span></span><span class="z-word"><span class="z-char">éšª</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ä¸€</span><span class="yin-symbol">ã„¢</span><span class="tone tone-3">Ë‡</span></span></span></label>
          <div class="input-group"><input id="impactInput" type="text"><button id="btnMicImpact" type="button" class="btn record">ğŸ¤</button></div>
        </div>

        <div style="margin-top:16px;">
          <label><span class="z-word"><span class="z-char">æ”¹</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">å–„</span><span class="z-yin"><span class="yin-symbol">ã„•</span><span class="yin-symbol">ã„¢</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">å°</span><span class="z-yin"><span class="yin-symbol">ã„‰</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„Ÿ</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">ç­–</span><span class="z-yin"><span class="yin-symbol">ã„˜</span><span class="yin-symbol">ã„œ</span><span class="tone tone-4">Ë‹</span></span></span></label>
          <div class="input-group"><input id="suggestionInput" type="text"><button id="btnMicSuggestion" type="button" class="btn record">ğŸ¤</button></div>
        </div>

        <div style="margin-top:16px;">
          <label>
  <span class="z-word"><span class="z-char">é¢¨</span><span class="z-yin"><span class="yin-symbol">ã„ˆ</span><span class="yin-symbol">ã„¥</span></span></span><span class="z-word"><span class="z-char">éšª</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">ç­‰</span><span class="z-yin"><span class="yin-symbol">ã„‰</span><span class="yin-symbol">ã„¥</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">ç´š</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„§</span><span class="tone tone-2">ËŠ</span></span></span>
</label>
          <div class="severity-group">
            <label class="checkbox-label"><input type="radio" name="severity" value="ğŸŸ¢ è¼•å¾®" checked><span class="z-word"><span class="z-char">ğŸŸ¢ è¼•</span><span class="z-yin"><span class="yin-symbol">ã„‘</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¥</span></span></span><span class="z-word"><span class="z-char">å¾®</span><span class="z-yin"><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„Ÿ</span><span class="tone tone-2">ËŠ</span></span></span><span style="font-weight:bold; margin-left:5px;">(</span><span class="z-word"><span class="z-char">è¼•</span><span class="z-yin"><span class="yin-symbol">ã„‘</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¥</span></span></span><span class="z-word"><span class="z-char">åº¦</span><span class="z-yin"><span class="yin-symbol">ã„‰</span><span class="yin-symbol">ã„¨</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">å½±</span><span class="z-yin"><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¥</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">éŸ¿</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¤</span><span class="tone tone-3">Ë‡</span></span></span><span style="margin:0 2px;">/</span><span class="z-word"><span class="z-char">å°</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„ </span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">ç¯„</span><span class="z-yin"><span class="yin-symbol">ã„ˆ</span><span class="yin-symbol">ã„¢</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">åœ</span><span class="z-yin"><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„Ÿ</span><span class="tone tone-2">ËŠ</span></span></span><span style="font-weight:bold;">)</span></label>
            <label class="checkbox-label"><input type="radio" name="severity" value="ğŸŸ¡ ä¸­åº¦"><span class="z-word"><span class="z-char">ğŸŸ¡ ä¸­</span><span class="z-yin"><span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„¥</span></span></span><span class="z-word"><span class="z-char">åº¦</span><span class="z-yin"><span class="yin-symbol">ã„‰</span><span class="yin-symbol">ã„¨</span><span class="tone tone-4">Ë‹</span></span></span><span style="font-weight:bold; margin-left:5px;">(</span><span class="z-word"><span class="z-char">ä¸­</span><span class="z-yin"><span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„¥</span></span></span><span class="z-word"><span class="z-char">åº¦</span><span class="z-yin"><span class="yin-symbol">ã„‰</span><span class="yin-symbol">ã„¨</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">å½±</span><span class="z-yin"><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¥</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">éŸ¿</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¤</span><span class="tone tone-3">Ë‡</span></span></span><span style="margin:0 2px;">/</span><span class="z-word"><span class="z-char">éœ€</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„©</span></span></span><span class="z-word"><span class="z-char">æ³¨</span><span class="z-yin"><span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„¨</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">æ„</span><span class="z-yin"><span class="yin-symbol">ã„§</span><span class="tone tone-4">Ë‹</span></span></span><span style="font-weight:bold;">)</span></label>
            <label class="checkbox-label"><input type="radio" name="severity" value="ğŸ”´ åš´é‡"><span class="z-word"><span class="z-char">ğŸ”´ åš´</span><span class="z-yin"><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">é‡</span><span class="z-yin"><span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„¥</span><span class="tone tone-4">Ë‹</span></span></span><span style="font-weight:bold; margin-left:5px;">(</span><span class="z-word"><span class="z-char">é‡</span><span class="z-yin"><span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„§</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">å¤§</span><span class="z-yin"><span class="yin-symbol">ã„‰</span><span class="yin-symbol">ã„š</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">å½±</span><span class="z-yin"><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¥</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">éŸ¿</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¤</span><span class="tone tone-3">Ë‡</span></span></span><span style="margin:0 2px;">/</span><span class="z-word"><span class="z-char">éœ€</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„©</span></span></span><span class="z-word"><span class="z-char">ç«‹</span><span class="z-yin"><span class="yin-symbol">ã„Œ</span><span class="yin-symbol">ã„§</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">å³</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„§</span><span class="tone tone-2">ËŠ</span></span></span><span style="font-weight:bold;">)</span></label>
          </div>
        </div>

        <div style="margin-top:16px;">
          <label>
            <span class="z-word"><span class="z-char">å½±</span><span class="z-yin"><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¥</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">éŸ¿</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¤</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">å±¤</span><span class="z-yin"><span class="yin-symbol">ã„˜</span><span class="yin-symbol">ã„¥</span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">é¢</span><span class="z-yin"><span class="yin-symbol">ã„‡</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span><span class="tone tone-4">Ë‹</span></span></span>
          </label>
          <div class="checkbox-group">
            <label class="checkbox-label"><input type="checkbox" name="scope" value="å®‰å…¨"><span class="z-word"><span class="z-char">å®‰</span><span class="z-yin"><span class="yin-symbol">ã„¢</span></span></span><span class="z-word"><span class="z-char">å…¨</span><span class="z-yin"><span class="yin-symbol">ã„‘</span><span class="yin-symbol">ã„©</span><span class="yin-symbol">ã„¢</span><span class="tone tone-2">ËŠ</span></span></span></label>
            <label class="checkbox-label"><input type="checkbox" name="scope" value="ç’°å¢ƒ"><span class="z-word"><span class="z-char">ç’°</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„¢</span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">å¢ƒ</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¥</span><span class="tone tone-4">Ë‹</span></span></span></label>
            <label class="checkbox-label"><input type="checkbox" name="scope" value="å¥åº·"><span class="z-word"><span class="z-char">å¥</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„§</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">åº·</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„¤</span></span></span></label>
            <label class="checkbox-label"><input type="checkbox" name="scope" value="äººéš›"><span class="z-word"><span class="z-char">äºº</span><span class="z-yin"><span class="yin-symbol">ã„–</span><span class="yin-symbol">ã„£</span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">éš›</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„§</span><span class="tone tone-4">Ë‹</span></span></span></label>
          </div>
        </div>
      </div>

      <div style="margin-top:30px; text-align:center;">
        <button id="btnGoPreview" type="button" class="btn large" disabled>
          <span class="z-word"><span class="z-char">ä¸‹</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„š</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">ä¸€</span><span class="z-yin"><span class="yin-symbol">ã„§</span></span></span><span class="z-word"><span class="z-char">æ­¥</span><span class="z-yin"><span class="yin-symbol">ã„…</span><span class="yin-symbol">ã„¨</span><span class="tone tone-4">Ë‹</span></span></span>
          <span style="font-weight:bold; margin:0 4px; font-size:1.2rem; vertical-align:middle;">ï¼Œ</span>
          <span class="z-word"><span class="z-char">é </span><span class="z-yin"><span class="yin-symbol">ã„©</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">è¦½</span><span class="z-yin"><span class="yin-symbol">ã„Œ</span><span class="yin-symbol">ã„¢</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">å°</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„ </span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">è¨˜</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„§</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">è€…</span><span class="z-yin"><span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„œ</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">å¿«</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">å ±</span><span class="z-yin"><span class="yin-symbol">ã„…</span><span class="yin-symbol">ã„ </span><span class="tone tone-4">Ë‹</span></span></span>
          <span style="margin-left:8px;">â¡</span>
        </button>
      </div>
    </div>

    <!-- é é¢ 2ï¼šé è¦½å€ -->
    <div id="page-preview" class="page-section">
      <div class="row between" style="margin-bottom:15px; background: rgba(255,255,255,0.7); padding: 10px; border-radius: 10px;">
       <button id="btnBackEditPreview" type="button" class="btn back">
  <span style="font-size: 1.1rem; vertical-align: middle; margin-right: 4px;">â¬…</span>
  <span class="z-word">
    <span class="z-char">å›</span>
    <span class="z-yin">
      <span class="yin-symbol">ã„</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„Ÿ</span><span class="tone tone-2">ËŠ</span>
    </span>
  </span>
  <span class="z-word">
    <span class="z-char">ä¸Š</span>
    <span class="z-yin">
      <span class="yin-symbol">ã„•</span><span class="yin-symbol">ã„¤</span><span class="tone tone-4">Ë‹</span>
    </span>
  </span>
  <span class="z-word">
    <span class="z-char">ä¸€</span>
    <span class="z-yin">
      <span class="yin-symbol">ã„§</span>
    </span>
  </span>
  <span class="z-word">
    <span class="z-char">æ­¥</span>
    <span class="z-yin">
      <span class="yin-symbol">ã„…</span><span class="yin-symbol">ã„¨</span><span class="tone tone-4">Ë‹</span>
    </span>
  </span>
</button>
        <div style="font-weight: bold; color: #1b5e20;">å¿«å ±é è¦½</div>
      </div>

      <div id="ai-loading"></div>

      <div id="report-final-container">
        <div id="report">
          <div class="news-header">
            <img src="https://lh3.googleusercontent.com/d/1ybyLQCc_DIAUeS23tz-sORNL43Vv2Kan" style="height: 60px;" alt="Logo" crossorigin="anonymous">
            <h1>
              <span class="z-word"><span class="z-char">æ°¸</span><span class="z-yin"><span class="yin-symbol">ã„©</span><span class="yin-symbol">ã„¥</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">çºŒ</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„©</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">ç”Ÿ</span><span class="z-yin"><span class="yin-symbol">ã„•</span><span class="yin-symbol">ã„¥</span></span></span><span class="z-word"><span class="z-char">æ´»</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„›</span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">å°</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„ </span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">è¨˜</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„§</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">è€…</span><span class="z-yin"><span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„œ</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">å¿«</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">å ±</span><span class="z-yin"><span class="yin-symbol">ã„…</span><span class="yin-symbol">ã„ </span><span class="tone tone-4">Ë‹</span></span></span>
            </h1>
          </div>
          
          <!-- ä¸»é¡Œæ¨™é¡Œï¼šAI ç”Ÿæˆï¼Œç½®ä¸­ -->
          <div id="rTitleContainer"></div>

          <div class="news-info">
            <div>
              <span class="z-word"><span class="z-char">è¨˜</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„§</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">è€…</span><span class="z-yin"><span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„œ</span><span class="tone tone-3">Ë‡</span></span></span>ï¼š
              <span id="rReporter"></span>
            </div>
            <div>
              <span class="z-word"><span class="z-char">æ™‚</span><span class="z-yin"><span class="yin-symbol">ã„•</span><span class="yin-symbol">ã„•</span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">é–“</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span></span></span>ï¼š
              <span id="rTime"></span>
            </div>
          </div>
          
          <!-- ç…§ç‰‡å€åŸŸèª¿æ•´ -->
          <div class="rImg-wrap">
            <img id="rImg" alt="å¿«å ±ç…§ç‰‡">
          </div>
          
          <div id="newsContent" class="news-content-block"></div>
          
          <div id="editArea" class="hidden" style="margin: 15px 0; border-top: 2px dashed #2e7d32; padding-top: 10px;">
             <textarea id="manualEditContent" rows="5" style="background: rgba(255,255,255,0.7);"></textarea>
             <div class="text-center mt-4">
                <button id="btnSaveManual" class="btn">
                   <span class="z-word"><span class="z-char">ä¿</span><span class="z-yin"><span class="yin-symbol">ã„…</span><span class="yin-symbol">ã„ </span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">å­˜</span><span class="z-yin"><span class="yin-symbol">ã„˜</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„£</span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">ä¿®</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¡</span></span></span><span class="z-word"><span class="z-char">æ”¹</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„</span><span class="tone tone-3">Ë‡</span></span></span>
                </button>
             </div>
          </div>

          <div class="news-footer">
            ä¸­è¯é›»ä¿¡ï½œæ°¸çºŒç”Ÿæ´»å°è¨˜è€…è¡Œå‹•è¨ˆç•«ï½œ2026
          </div>
        </div>
      </div>
      
      <!-- æ§åˆ¶é¢æ¿æ•´åˆç‚ºä¸€åˆ— -->
      <div id="controlPanel" class="text-center mt-4" style="padding-bottom: 50px;">
        <div class="row center">
          <button id="btnManualEdit" class="btn edit">
             <span class="z-word"><span class="z-char">ä¿®</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¡</span></span></span><span class="z-word"><span class="z-char">æ”¹</span><span class="z-yin"><span class="yin-symbol">ã„</span><span class="yin-symbol">ã„</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">å ±</span><span class="z-yin"><span class="yin-symbol">ã„…</span><span class="yin-symbol">ã„ </span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">å°</span><span class="z-yin"><span class="yin-symbol">ã„‰</span><span class="yin-symbol">ã„ </span><span class="tone tone-3">Ë‡</span></span></span>
          </button>
          <button id="btnRetryAI" class="btn retry">
             <span class="z-word"><span class="z-char">A</span></span><span class="z-word"><span class="z-char">I</span></span><span class="z-word"><span class="z-char">é‡</span><span class="z-yin"><span class="yin-symbol">ã„”</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„¥</span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">æ–°</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„£</span></span></span><span class="z-word"><span class="z-char">ç”Ÿ</span><span class="z-yin"><span class="yin-symbol">ã„•</span><span class="yin-symbol">ã„¥</span></span></span><span class="z-word"><span class="z-char">æˆ</span><span class="z-yin"><span class="yin-symbol">ã„”</span><span class="yin-symbol">ã„”</span><span class="tone tone-2">ËŠ</span></span></span>
          </button>
          <button id="btnDownload" class="btn large" style="width: auto;">
             <span class="z-word"><span class="z-char">ä¸‹</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„š</span><span class="tone tone-4">Ë‹</span></span></span><span class="z-word"><span class="z-char">è¼‰</span><span class="z-yin"><span class="yin-symbol">ã„—</span><span class="yin-symbol">ã„</span><span class="tone tone-3">Ë‡</span></span></span><span class="z-word"><span class="z-char">åœ–</span><span class="z-yin"><span class="yin-symbol">ã„Š</span><span class="yin-symbol">ã„¨</span><span class="tone tone-2">ËŠ</span></span></span><span class="z-word"><span class="z-char">ç‰‡</span><span class="z-yin"><span class="yin-symbol">ã„†</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span><span class="tone tone-4">Ë‹</span></span></span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script>
    const apiKey = ""; 

    function switchPage(id) {
      document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      window.scrollTo(0, 0);
    }

    const canvas = document.getElementById("canvas"), ctx = canvas.getContext("2d");
    const photoInput = document.getElementById("photoInput"), placeholderText = document.getElementById("placeholderText");
    let baseImage = null, circles = [], isDrawing = false, startX, startY;

    function redraw() {
      if(!baseImage) return;
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.drawImage(baseImage, 0, 0, canvas.width, canvas.height);
      ctx.lineWidth = 6; ctx.strokeStyle = "red";
      circles.forEach(c => { ctx.beginPath(); ctx.ellipse(c.cx, c.cy, c.rx, c.ry, 0, 0, Math.PI*2); ctx.stroke(); });
    }

    function getPos(e) {
      const rect = canvas.getBoundingClientRect();
      const cx = e.touches ? e.touches[0].clientX : e.clientX, cy = e.touches ? e.touches[0].clientY : e.clientY;
      return { x: (cx - rect.left) * (canvas.width / rect.width), y: (cy - rect.top) * (canvas.height / rect.height) };
    }

    canvas.addEventListener('mousedown', s => { if(!baseImage)return; isDrawing=true; let p=getPos(s); startX=p.x; startY=p.y; });
    canvas.addEventListener('touchstart', s => { if(!baseImage)return; isDrawing=true; let p=getPos(s); startX=p.x; startY=p.y; s.preventDefault(); }, {passive:false});
    window.addEventListener('mousemove', m => { if(!isDrawing)return; let p=getPos(m); redraw(); let cx=(startX+p.x)/2, cy=(startY+p.y)/2, rx=Math.abs(p.x-startX)/2, ry=Math.abs(p.y-startY)/2; ctx.beginPath(); ctx.ellipse(cx,cy,rx,ry,0,0,Math.PI*2); ctx.stroke(); });
    window.addEventListener('touchmove', m => { if(!isDrawing)return; let p=getPos(m); redraw(); let cx=(startX+p.x)/2, cy=(startY+p.y)/2, rx=Math.abs(p.x-startX)/2, ry=Math.abs(p.y-startY)/2; ctx.beginPath(); ctx.ellipse(cx,cy,rx,ry,0,0,Math.PI*2); ctx.stroke(); m.preventDefault(); }, {passive:false});
    window.addEventListener('mouseup', e => { if(!isDrawing)return; isDrawing=false; let p=getPos(e); let cx=(startX+p.x)/2, cy=(startY+p.y)/2, rx=Math.abs(p.x-startX)/2, ry=Math.abs(p.y-startY)/2; if(rx>5||ry>5)circles.push({cx,cy,rx,ry}); redraw(); updateBtns(); });
    window.addEventListener('touchend', e => { if(!isDrawing)return; isDrawing=false; let p=getPos(e.changedTouches[0]); let cx=(startX+p.x)/2, cy=(startY+p.y)/2, rx=Math.abs(p.x-startX)/2, ry=Math.abs(p.y-startY)/2; if(rx>5||ry>5)circles.push({cx,cy,rx,ry}); redraw(); updateBtns(); });

    photoInput.addEventListener('change', e => {
      let f = e.target.files[0]; if(!f) return;
      let i = new Image(); i.onload = () => {
        let s = Math.min(1200/i.width, 900/i.height);
        canvas.width = i.width*s; canvas.height = i.height*s;
        baseImage = i; circles = []; canvas.classList.remove('hidden'); placeholderText.classList.add('hidden'); redraw();
        document.getElementById('btnGoPreview').disabled = false;
      }; i.src = URL.createObjectURL(f);
    });

    function updateBtns() { document.getElementById('btnUndo').disabled = (circles.length === 0); document.getElementById('btnClear').disabled = (circles.length === 0); }
    document.getElementById('btnUndo').addEventListener('click', () => { circles.pop(); redraw(); updateBtns(); });
    document.getElementById('btnClear').addEventListener('click', () => { circles = []; redraw(); updateBtns(); });

    // é€šç”¨å‚ç›´æ³¨éŸ³ç”Ÿæˆ (åŠ å¼·éæ¿¾)
    function getZWord(char, yin, tone) {
      // å¦‚æœæ˜¯æ¨™é»ç¬¦è™Ÿï¼ˆåŒ…å«å…¨å½¢é€—è™Ÿã€å¥è™Ÿã€å†’è™Ÿç­‰ï¼‰
  if (char && char.match(/[ï¼Œã€‚ï¼šï¼›ï¼ï¼Ÿï¼ˆï¼‰ã€]/)) {
    return `<span class="z-punctuation">${char}</span>`;
  }
      if (!char || !char.match(/[\u4e00-\u9fa5]/)) return char || ""; 
      let tHtml = "";
      if (tone === "2") tHtml = '<span class="tone tone-2">ËŠ</span>';
      else if (tone === "3") tHtml = '<span class="tone tone-3">Ë‡</span>';
      else if (tone === "4") tHtml = '<span class="tone tone-4">Ë‹</span>';
      else if (tone === "0") tHtml = '<span class="tone tone-0">Ë™</span>';
      
      let cleanYin = (yin || "").replace(/[ËŠË‡Ë‹Ë™]/g, "");
      let vy = ""; for (let s of cleanYin) vy += `<span class="yin-symbol">${s}</span>`;
      return `<span class="z-word"><span class="z-char">${char}</span><span class="z-yin">${vy}${tHtml}</span></span>`;
    }

    // æç¤ºæ–‡å­—åŠ æ³¨éŸ³
// æç¤ºæ–‡å­—åŠ æ³¨éŸ³ (åŠ å¼·ç‰ˆï¼šæ”¯æ´ç‰¹å®šè¨Šæ¯æ‰‹å¯«æ³¨éŸ³èˆ‡å‹•ç•«)
function setZLoadingText(text) {
  const loadingElement = document.getElementById('ai-loading');
  if (!loadingElement) return;

  let htmlContent = "";
  const icon = `<div class="waiting-icon">â³</div>`;

  // 1. AI æ’°å¯«ä¸­
  if (text.includes("æ’°å¯«ä¸­")) {
    htmlContent = `${icon}
      <span class="z-word"><span class="z-char">ï¼¡</span></span><span class="z-word"><span class="z-char">ï¼©</span></span>
      <span class="z-word"><span class="z-char">æ’°</span><span class="z-yin"><span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„¢</span><span class="tone tone-4">Ë‹</span></span></span>
      <span class="z-word"><span class="z-char">å¯«</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„</span><span class="tone tone-3">Ë‡</span></span></span>
      <span class="z-word"><span class="z-char">ä¸­</span><span class="z-yin"><span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„¥</span></span></span><span class="z-punctuation">...</span>`;
  } 
  // 2. é€£ç·šé€¾æ™‚
  else if (text.includes("é€¾æ™‚")) {
    htmlContent = `âŒ 
      <span class="z-word"><span class="z-char">é€£</span><span class="z-yin"><span class="yin-symbol">ã„Œ</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span><span class="tone tone-2">ËŠ</span></span></span>
      <span class="z-word"><span class="z-char">ç·š</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¢</span><span class="tone tone-4">Ë‹</span></span></span>
      <span class="z-word"><span class="z-char">é€¾</span><span class="z-yin"><span class="yin-symbol">ã„©</span><span class="tone tone-2">ËŠ</span></span></span>
      <span class="z-word"><span class="z-char">æ™‚</span><span class="z-yin"><span class="yin-symbol">ã„•</span><span class="tone tone-2">ËŠ</span></span></span>ï¼Œ
      <span class="z-word"><span class="z-char">è«‹</span><span class="z-yin"><span class="yin-symbol">ã„‘</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„¥</span><span class="tone tone-3">Ë‡</span></span></span>
      <span class="z-word"><span class="z-char">é‡</span><span class="z-yin"><span class="yin-symbol">ã„”</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„¥</span><span class="tone tone-2">ËŠ</span></span></span>
      <span class="z-word"><span class="z-char">è©¦</span><span class="z-yin"><span class="yin-symbol">ã„•</span><span class="tone tone-4">Ë‹</span></span></span>`;
  }
  // 3. æ­£åœ¨é‡æ–°ç”¢ç”Ÿæ’ç‰ˆ
  else if (text.includes("é‡æ–°ç”¢ç”Ÿ")) {
    htmlContent = `${icon}
      <span class="z-word"><span class="z-char">æ­£</span><span class="z-yin"><span class="yin-symbol">ã„“</span><span class="yin-symbol">ã„¥</span><span class="tone tone-4">Ë‹</span></span></span>
      <span class="z-word"><span class="z-char">åœ¨</span><span class="z-yin"><span class="yin-symbol">ã„—</span><span class="yin-symbol">ã„</span><span class="tone tone-4">Ë‹</span></span></span>
      <span class="z-word"><span class="z-char">é‡</span><span class="z-yin"><span class="yin-symbol">ã„”</span><span class="yin-symbol">ã„¨</span><span class="yin-symbol">ã„¥</span><span class="tone tone-2">ËŠ</span></span></span>
      <span class="z-word"><span class="z-char">æ–°</span><span class="z-yin"><span class="yin-symbol">ã„’</span><span class="yin-symbol">ã„§</span><span class="yin-symbol">ã„£</span></span></span>
      <span class="z-word"><span class="z-char">ç”¢</span><span class="z-yin"><span class="yin-symbol">ã„”</span><span class="yin-symbol">ã„¢</span><span class="tone tone-3">Ë‡</span></span></span>
      <span class="z-word"><span class="z-char">ç”Ÿ</span><span class="z-yin"><span class="yin-symbol">ã„•</span><span class="yin-symbol">ã„¥</span></span></span><span class="z-punctuation">...</span>`;
  }
  else {
    // å…¶ä»–æ–‡å­— (é é˜²è¬ä¸€ç”¨çš„ä¿åº•é‚è¼¯)
    let html = "";
    for(let c of text) html += getZWord(c, "", "");
    htmlContent = html;
  }

  loadingElement.innerHTML = `<div class="loading-container">${htmlContent}</div>`;
}

    async function callGemini(promptText) {
       try {
        const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
          method: 'POST', headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ contents: [{ parts: [{ text: promptText }] }], generationConfig: { responseMimeType: "application/json" } })
        });
        const data = await res.json();
        return JSON.parse(data.candidates[0].content.parts[0].text);
      } catch (e) { return null; }
    }

    async function generateAIContent(loc, prob, impact, sug, reporter, scope) {
      const prompt = `æ‚¨æ˜¯ä¸€ä½å°ˆæ¥­çš„åœ‹å°è¨˜è€…å°å¸«ã€‚æ’°å¯«ä¸€ç¯‡å…·å‚™æ–°èæ„Ÿçš„å°ˆæ¥­å¿«å ±ã€‚è¦æ±‚ï¼š
      1. ç”Ÿæˆå…·å‚™æ–°èæ„Ÿçš„è³å‹•æ¨™é¡Œ(title)ï¼Œæœ€å¤š20å­—ã€‚
      2. å…§æ–‡(body)é–‹é ­ï¼šã€Œæœ¬å ±å°è¨˜è€…${reporter}ï¼Œç™¼ç¾...ã€ã€‚
      3. å…§å®¹åŒ…å«ç™¼ç¾å•é¡Œã€å»ºè­°æ ¡å‹™å–®ä½ã€ä»¥åŠåŒå­¸é é˜²æªæ–½ã€‚
      4. ç¸½å­—æ•¸é™åˆ¶åœ¨ 120-150 å­—ã€‚
      ã€æ³¨éŸ³è¦ç¯„ã€‘å¿…é ˆæ˜¯å°ç£ã„…ã„†ã„‡ã„ˆç¬¦è™Ÿï¼ˆä¾‹ï¼šã€Œå¤§ã€æ˜¯ã€Œã„‰ã„šã€ï¼Œä¸å¯å‡ºç¾ daï¼‰ã€‚
      å›å‚³ JSONï¼š{"title": [{"c": "å­—", "y": "æ³¨éŸ³", "t": "è²èª¿"}...], "body": [...]}ã€‚`;
      return await callGemini(prompt + `\nè³‡è¨Šï¼šåœ°é»:${loc}, å•é¡Œ:${prob}, é¢¨éšª:${impact}, å»ºè­°:${sug}, å±¤é¢:${scope}`);
    }

    async function reZhuyinText(plainText) {
      const prompt = `å°‡æ–‡å­—è½‰ç‚ºå°ç£æ³¨éŸ³ JSON é™£åˆ—ï¼š${plainText}
      å›å‚³æ ¼å¼ï¼š[{"c": "å­—", "y": "æ³¨éŸ³", "t": "è²èª¿æ•¸å­—"}...]ã€‚ç¦æ­¢ç¾…é¦¬æ‹¼éŸ³ã€‚`;
      return await callGemini(prompt);
    }

    async function startReporting() {
      const reporter = document.getElementById('reporterName').value || "å°è¨˜è€…";
      const team = document.getElementById('team').value || "æœªé¸çµ„";
      const loc = document.getElementById('locationInput').value || "æ ¡åœ’";
      const scope = Array.from(document.querySelectorAll('input[name="scope"]:checked')).map(cb => cb.value).join("ã€") || "æ ¡åœ’å®‰å…¨";

      document.getElementById('rReporter').textContent = reporter + " (" + team + ")";
      document.getElementById('rTime').textContent = new Date().toLocaleString('zh-TW');
      document.getElementById('rImg').src = canvas.toDataURL();
      
      switchPage('page-preview');
      document.getElementById('report-final-container').style.opacity = "0.3";
      document.getElementById('ai-loading').style.display = 'block';
      setZLoadingText("ï¼¡ï¼©æ’°å¯«ä¸­...");
      document.getElementById('newsContent').innerHTML = "";
      document.getElementById('rTitleContainer').innerHTML = "";

      const aiData = await generateAIContent(loc, document.getElementById('problemInput').value, document.getElementById('impactInput').value, document.getElementById('suggestionInput').value, reporter, scope);
      document.getElementById('ai-loading').style.display = 'none';
      document.getElementById('report-final-container').style.opacity = "1";

      if(aiData && aiData.title && aiData.body) {
        let th = ""; aiData.title.forEach(i => { th += getZWord(i.c, i.y, i.t); });
        document.getElementById('rTitleContainer').innerHTML = th;
        let bh = ""; aiData.body.forEach(i => { bh += getZWord(i.c, i.y, i.t); });
        document.getElementById('newsContent').innerHTML = bh;
        document.getElementById('manualEditContent').value = aiData.body.map(i => i.c).join("");
      } else {
        document.getElementById('newsContent').innerHTML = "AI ç”Ÿæˆé€£ç·šé€¾æ™‚ï¼Œè«‹é‡è©¦æˆ–æ‰‹å‹•ä¿®æ”¹ã€‚";
      }
    }

    document.getElementById('btnGoPreview').onclick = startReporting;
    document.getElementById('btnRetryAI').onclick = startReporting;
    document.getElementById('btnBackEditPreview').onclick = () => switchPage('page-edit');

    document.getElementById('btnManualEdit').onclick = () => {
      document.getElementById('editArea').classList.toggle('hidden');
    };

    document.getElementById('btnSaveManual').onclick = async () => {
      const text = document.getElementById('manualEditContent').value;
      if(!text) return;
      document.getElementById('ai-loading').style.display = 'block';
      setZLoadingText("æ­£åœ¨é‡æ–°ç”¢ç”Ÿæ’ç‰ˆ...");
      const aiJson = await reZhuyinText(text);
      document.getElementById('ai-loading').style.display = 'none';
      if(aiJson && Array.isArray(aiJson)) {
        let html = "";
        aiJson.forEach(item => { html += getZWord(item.c, item.y, item.t); });
        document.getElementById('newsContent').innerHTML = html;
        document.getElementById('editArea').classList.add('hidden');
      }
    };

    document.getElementById('btnDownload').onclick = async () => {
      const reportDiv = document.getElementById('report');
      document.getElementById('editArea').classList.add('hidden');
      const controlPanel = document.getElementById('controlPanel');
      controlPanel.style.display = 'none';
      document.getElementById('btnBackEditPreview').style.display = 'none';

      try {
        const s = await html2canvas(reportDiv, { 
          scale: 3, 
          useCORS: true, 
          backgroundColor: "#ffffff",
          width: 794,
          height: 1123
        });
        const a = document.createElement("a");
        a.href = s.toDataURL("image/png");
        a.download = `å°è¨˜è€…ç”Ÿæ´»å¿«å ±_${new Date().getTime()}.png`;
        a.click();
      } catch (e) { console.error(e); }
      
      controlPanel.style.display = 'block';
      document.getElementById('btnBackEditPreview').style.display = 'inline-flex';
    };

    function setupMic(bI, iI) {
      document.getElementById(bI).onclick = () => {
        const S = window.webkitSpeechRecognition || window.SpeechRecognition;
        if(!S) return;
        const r = new S(); r.lang = 'zh-TW';
        r.onstart = () => document.getElementById(bI).classList.add('recording');
        r.onend = () => document.getElementById(bI).classList.remove('recording');
        r.onresult = (e) => document.getElementById(iI).value = e.results[0][0].transcript;
        r.start();
      };
    }
    setupMic("btnMicLocation", "locationInput"); setupMic("btnMicProblem", "problemInput"); setupMic("btnMicImpact", "impactInput"); setupMic("btnMicSuggestion", "suggestionInput");
  </script>
</body>
</html>
